import*as t from"../highcharts.js";import"./exporting.js";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a:a}),a},d:(t,a)=>{for(var o in a)e.o(a,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:a[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};let a=t.default;var o=e.n(a);let{isSafari:n,win:i,win:{document:r}}=o(),l=i.URL||i.webkitURL||i;function s(o){o=o.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([A-Z+\d\/]+)/i);if(o&&3<o.length&&i.atob&&i.ArrayBuffer&&i.Uint8Array&&i.Blob&&l.createObjectURL){let e=i.atob(o[3]),t=new i.ArrayBuffer(e.length),a=new i.Uint8Array(t);for(let t=0;t<a.length;++t)a[t]=e.charCodeAt(t);return l.createObjectURL(new i.Blob([a],{type:o[1]}))}}let h={dataURLtoBlob:s,downloadURL:function(t,e){let a=i.navigator,o=r.createElement("a");if("string"==typeof t||t instanceof String||!a.msSaveOrOpenBlob){if(t=""+t,1e3<a.userAgent.length)throw Error("Input too long");var l=/Edge\/\d+/.test(a.userAgent);if((n&&"string"==typeof t&&0===t.indexOf("data:application/pdf")||l||2e6<t.length)&&!(t=s(t)||""))throw Error("Failed to convert to blob");if(void 0!==o.download)o.href=t,o.download=e,r.body.appendChild(o),o.click(),r.body.removeChild(o);else try{if(!i.open(t,"chart"))throw Error("Failed to open window")}catch{i.location.href=t}}else a.msSaveOrOpenBlob(t,e)}},c=t.default.AST;var d=e.n(c);let p={exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0,showExportInProgress:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table",hideData:"Hide data table",exportInProgress:"Exporting..."}},{getOptions:u,setOptions:g}=o(),m=h["downloadURL"],{doc:f,win:x}=o(),{addEvent:b,defined:y,extend:w,find:T,fireEvent:D,isNumber:v,pick:S}=o();function L(t){let e=!!this.options.exporting?.showExportInProgress,a=x.requestAnimationFrame||setTimeout;a(()=>{e&&this.showLoading(this.options.lang.exportInProgress),a(()=>{try{t.call(this)}finally{e&&this.hideLoading()}})})}function E(){L.call(this,()=>{var t=this.getCSV(!0);m(F(t,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(t),this.getFilename()+".csv")})}function A(){L.call(this,()=>{var t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";m(F(t,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+x.btoa(unescape(encodeURIComponent(t))),this.getFilename()+".xls")})}function C(t){let i="",n=this.getDataRows(),e=this.options.exporting.csv,r=S(e.decimalPoint,","!==e.itemDelimiter&&t?1.1.toLocaleString()[1]:"."),s=S(e.itemDelimiter,","===r?";":","),l=e.lineDelimiter;return n.forEach((t,e)=>{let a="",o=t.length;for(;o--;)"number"==typeof(a="string"==typeof(a=t[o])?`"${a}"`:a)&&"."!==r&&(a=a.toString().replace(".",r)),t[o]=a;t.length=n.length?n[0].length:0,i+=t.join(s),e<n.length-1&&(i+=l)}),i}function k(i){function n(t,e,a){if(w.columnHeaderFormatter){var o=w.columnHeaderFormatter(t,e,a);if(!1!==o)return o}return t?t.bindAxes?i?{columnTitle:1<a?e:t.name,topLevelColumnTitle:t.name}:t.name+(1<a?" ("+e+")":""):t.options.title&&t.options.title.text||(t.dateTime?l:s):s}function f(a,t,o){let i={},n={};return t.forEach(function(t){var e=(a.keyToAxis&&a.keyToAxis[t]||t)+"Axis",e=v(o)?a.chart[e][o]:a[e];i[t]=e&&e.categories||[],n[t]=e&&e.dateTime}),{categoryMap:i,dateTimeValueAxisMap:n}}let a,o,x=this.hasParallelCoordinates,b=this.time,w=this.options.exporting&&this.options.exporting.csv||{},r=this.xAxis,L={},t=[],E=[],C=[],e=this.options.lang.exportData,s=e.categoryHeader,l=e.categoryDatetimeHeader,A=[],h,d,O,k=0,c,p;for(c in this.series.forEach(function(s){let t=s.options.keys,l=s.xAxis,h=t||(a=l,o=(e=s).pointArrayMap||["y"],e.data.some(t=>void 0!==t.y&&t.name)&&a&&!a.categories&&"name"!==e.exportKey?["x",...o]:o),d=h.length,c=!s.requireSorting&&{},p=r.indexOf(l),g=f(s,h),u,m;var e,a,o;if(!1!==s.options.includeInDataExport&&!s.options.isInternal&&!1!==s.visible){for(T(A,function(t){return t[0]===p})||A.push([p,k]),m=0;m<d;)O=n(s,h[m],h.length),C.push(O.columnTitle||O),i&&E.push(O.topLevelColumnTitle||O),m++;u={chart:s.chart,autoIncrement:s.autoIncrement,options:s.options,pointArrayMap:s.pointArrayMap,index:s.index},s.options.data.forEach(function(t,e){let a,o,i,n={series:u};x&&(g=f(s,h,e)),s.pointClass.prototype.applyOptions.apply(n,[t]);t=s.data[e]&&s.data[e].name;if(a=(n.x??"")+","+t,m=0,(!l||"name"===s.exportKey||!x&&l&&l.hasNames&&t)&&(a=t),c&&(c[a]&&(a+="|"+e),c[a]=!0),L[a]){var e=a+","+L[a].pointers[s.index],r=a;L[a].pointers[s.index]&&(L[e]||(L[e]=[],L[e].xValues=[],L[e].pointers=[]),a=e),L[r].pointers[s.index]+=1}else{L[a]=[],L[a].xValues=[];let e=[];for(let t=0;t<s.chart.series.length;t++)e[t]=0;L[a].pointers=e,L[a].pointers[s.index]=1}for(L[a].x=n.x,L[a].name=t,L[a].xValues[p]=n.x;m<d;)o=h[m],i=s.pointClass.prototype.getNestedProperty.apply(n,[o]),L[a][k+m]=S(g.categoryMap[o][i],g.dateTimeValueAxisMap[o]?b.dateFormat(w.dateFormat,i):null,i),m++}),k+=m}}),L)Object.hasOwnProperty.call(L,c)&&t.push(L[c]);for(d=i?[E,C]:[C],k=A.length;k--;)a=A[k][0],o=A[k][1],h=r[a],t.sort(function(t,e){return t.xValues[a]-e.xValues[a]}),p=n(h),d[0].splice(o,0,p),i&&d[1]&&d[1].splice(o,0,p),t.forEach(function(t){let e=t.name;h&&!y(e)&&(e=h.dateTime?(t.x instanceof Date&&(t.x=t.x.getTime()),b.dateFormat(w.dateFormat,t.x)):h.categories?S(h.names[t.x],h.categories[t.x],t.x):t.x),t.splice(o,0,e)});return D(this,"exportData",{dataRows:d=d.concat(t)}),d}function O(t){let e=t=>{if(!t.tagName||"#text"===t.tagName)return t.textContent||"";let a=t.attributes,o="<"+t.tagName;return a&&Object.keys(a).forEach(t=>{var e=a[t];o+=` ${t}="${e}"`}),o=(o+=">")+(t.textContent||""),(t.children||[]).forEach(t=>{o+=e(t)}),o+=`</${t.tagName}>`};return e(this.getTableAST(t))}function R(t){function h(t,e,a,o){let i=S(o,""),n="highcharts-text"+(e?" "+e:"");return"number"==typeof i?(i=i.toString(),","===r&&(i=i.replace(".",r)),n="highcharts-number"):o||(n="highcharts-empty"),{tagName:t,attributes:a=w({class:n},a),textContent:i}}let d=0,e=[],c=this.options,r=t?1.1.toLocaleString()[1]:".",p=S(c.exporting.useMultiLevelHeaders,!0),a=this.getDataRows(p),o=p?a.shift():null,g=a.shift(),i=(c.exporting||{})["tableCaption"];!1!==i&&e.push({tagName:"caption",attributes:{class:"highcharts-table-caption"},textContent:"string"==typeof i?i:c.title?.text||c.lang.chartTitle});for(let t=0,e=a.length;t<e;++t)a[t].length>d&&(d=a[t].length);e.push(function(t,a){let o=[],i=0,n=Math.max(d,g.length)||a&&a.length,r,s=0,l;if(p&&t&&a&&!function(t,e){let a=t.length;if(e.length!==a)return!1;for(;a--;)if(t[a]!==e[a])return!1;return!0}(t,a)){let e=[];for(;i<n;++i)if((r=t[i])===t[i+1])++s;else if(s)e.push(h("th","highcharts-table-topheading",{scope:"col",colspan:s+1},r)),s=0;else{r===a[i]?c.exporting.useRowspanHeaders?(l=2,delete a[i]):(l=1,a[i]=""):l=1;let t=h("th","highcharts-table-topheading",{scope:"col"},r);1<l&&t.attributes&&(t.attributes.valign="top",t.attributes.rowspan=l),e.push(t)}o.push({tagName:"tr",children:e})}if(a){let t=[];for(i=0,n=a.length;i<n;++i)void 0!==a[i]&&t.push(h("th",null,{scope:"col"},a[i]));o.push({tagName:"tr",children:t})}return{tagName:"thead",children:o}}(o,g));let n=[];a.forEach(function(e){let a=[];for(let t=0;t<d;t++)a.push(h(t?"td":"th",null,t?{}:{scope:"row"},e[t]));n.push({tagName:"tr",children:a})}),e.push({tagName:"tbody",children:n});t={tree:{tagName:"table",id:"highcharts-data-table-"+this.index,children:e}};return D(this,"aftergetTableAST",t),t.tree}function N(){this.toggleDataTable(!1)}function V(a){var o=(a=S(a,!this.isDataTableVisible))&&!this.dataTableDiv;if(o&&(this.dataTableDiv=f.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv){let t=this.dataTableDiv.style,e=t.display;t.display=a?"block":"none",a?(this.dataTableDiv.innerHTML=d().emptyHTML,new(d())([this.getTableAST()]).addToDOM(this.dataTableDiv),D(this,"afterViewData",{element:this.dataTableDiv,wasHidden:o||e!==t.display})):D(this,"afterHideData")}this.isDataTableVisible=a;let t=this.exportDivElements,e=this.options.exporting,i=e&&e.buttons&&e.buttons.contextButton.menuItems,n=this.options.lang;e&&e.menuItemDefinitions&&n&&n.viewData&&n.hideData&&i&&t&&((o=t[i.indexOf("viewData")])&&d().setElementHTML(o,this.isDataTableVisible?n.hideData:n.viewData))}function B(){this.toggleDataTable(!0)}function F(e,t){let a=x.navigator,o=x.URL||x.webkitURL||x;try{if(a.msSaveOrOpenBlob&&x.MSBlobBuilder){let t=new x.MSBlobBuilder;return t.append(e),t.getBlob("image/svg+xml")}return o.createObjectURL(new x.Blob(["\ufeff"+e],{type:t}))}catch(e){}}function I(){let r=this,s=r.dataTableDiv,l=(t,e)=>t.children[e].textContent;if(s&&r.options.exporting&&r.options.exporting.allowTableSorting){let t=s.querySelector("thead tr");t&&t.childNodes.forEach(a=>{let o=a.closest("table");a.addEventListener("click",function(){let t=[...s.querySelectorAll("tr:not(thead tr)")],e=[...a.parentNode.children];var i,n;t.sort((i=e.indexOf(a),n=r.ascendingOrderInTable=!r.ascendingOrderInTable,(t,e)=>{let a,o;return a=l(n?t:e,i),o=l(n?e:t,i),""===a||""===o||isNaN(a)||isNaN(o)?a.toString().localeCompare(o):a-o})).forEach(t=>{o.appendChild(t)}),e.forEach(e=>{["highcharts-sort-ascending","highcharts-sort-descending"].forEach(t=>{e.classList.contains(t)&&e.classList.remove(t)})}),a.classList.add(r.ascendingOrderInTable?"highcharts-sort-ascending":"highcharts-sort-descending")})})}}function U(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}function H(){this.dataTableDiv?.remove()}e.d({},{});let M=o(),P=(M.dataURLtoBlob=M.dataURLtoBlob||h.dataURLtoBlob,M.downloadURL=M.downloadURL||h.downloadURL,function(s,l){let h=s.prototype;if(!h.getCSV){let t=u().exporting,{arearange:e,gantt:a,map:o,mapbubble:i,treemap:n,xrange:r}=(b(s,"afterViewData",I),b(s,"render",U),b(s,"destroy",H),h.downloadCSV=E,h.downloadXLS=A,h.getCSV=C,h.getDataRows=k,h.getTable=O,h.getTableAST=R,h.hideData=N,h.toggleDataTable=V,h.viewData=B,t&&(w(t.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){L.call(this,this.toggleDataTable)}}}),t.buttons&&t.buttons.contextButton.menuItems&&t.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")),g(p),l.types);e&&(e.prototype.keyToAxis={low:"y",high:"y"}),a&&(a.prototype.exportKey="name",a.prototype.keyToAxis={start:"x",end:"x"}),o&&(o.prototype.exportKey="name"),i&&(i.prototype.exportKey="name"),n&&(n.prototype.exportKey="name"),r&&(r.prototype.keyToAxis={x2:"x"})}}(M.Chart,M.Series),o());export{P as default};