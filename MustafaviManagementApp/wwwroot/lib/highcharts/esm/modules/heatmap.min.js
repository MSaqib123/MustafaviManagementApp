import*as t from"../highcharts.js";import"./coloraxis.js";var e,r={n:t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},d:(t,e)=>{for(var a in e)r.o(e,a)&&!r.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};let i=t.default;var a=r.n(i);r.d({},{});let s=t.default.Color;var o=r.n(s);let l=t.default.SeriesRegistry;var n=r.n(l);let h=t.default.SVGElement;var p=r.n(h);let{prototype:d}=n().seriesTypes["column"],{addEvent:u,defined:c}=a(),m=(!function(t){function e(t){let e=this.series,r=e.chart.renderer;this.moveToTopOnHover&&this.graphic&&(e.stateMarkerGraphic||(e.stateMarkerGraphic=new(p())(r,"use").css({pointerEvents:"none"}).add(this.graphic.parentGroup)),"hover"===t?.state?(this.graphic.attr({id:this.id}),e.stateMarkerGraphic.attr({href:r.url+"#"+this.id,visibility:"visible"})):e.stateMarkerGraphic.attr({href:""}))}t.pointMembers={dataLabelOnNull:!0,moveToTopOnHover:!0,isValid:function(){return null!==this.value&&this.value!==1/0&&this.value!==-1/0&&(void 0===this.value||!isNaN(this.value))}},t.seriesMembers={colorKey:"value",axisTypes:["xAxis","yAxis","colorAxis"],parallelArrays:["x","y","value"],pointArrayMap:["value"],trackerGroups:["group","markerGroup","dataLabelsGroup"],colorAttribs:function(t){let e={};return!c(t.color)||t.state&&"normal"!==t.state||(e[this.colorProp||"fill"]=t.color),e},pointAttribs:d.pointAttribs},t.compose=function(t){return u(t.prototype.pointClass,"afterSetState",e),t}}(e=e||{}),e),{prototype:{pointClass:y}}=n().seriesTypes["scatter"],{clamp:g,defined:b,extend:f,pick:x}=a();class v extends y{applyOptions(t,e){return!this.isNull&&null!==this.value||delete this.color,super.applyOptions(t,e),this.formatPrefix=this.isNull||null===this.value?"null":"point",this}getCellAttributes(){let t=this.series,e=t.options,r=(e.colsize||1)/2,a=(e.rowsize||1)/2,n=t.xAxis,h=t.yAxis,p=this.options.marker||t.options.marker,i=t.pointPlacementToXValue(),d=x(this.pointPadding,e.pointPadding,0),u={x1:g(Math.round(n.len-n.translate(this.x-r,!1,!0,!1,!0,-i)),-n.len,2*n.len),x2:g(Math.round(n.len-n.translate(this.x+r,!1,!0,!1,!0,-i)),-n.len,2*n.len),y1:g(Math.round(h.translate(this.y-a,!1,!0,!1,!0)),-h.len,2*h.len),y2:g(Math.round(h.translate(this.y+a,!1,!0,!1,!0)),-h.len,2*h.len)};for(var c of[["width","x"],["height","y"]]){let t=c[0],e=c[1],r=e+"1",a=e+"2",i=Math.abs(u[r]-u[a]),s=p&&p.lineWidth||0,o=Math.abs(u[r]+u[a])/2,l=p&&p[t];b(l)&&l<i&&(c=l/2+s/2,u[r]=o-c,u[a]=o+c),d&&(("x"===e&&n.reversed||"y"===e&&!h.reversed)&&(r=a,a=e+"1"),u[r]+=d,u[a]-=d)}return u}haloPath(t){if(!t)return[];var{x:e=0,y:r=0,width:a=0,height:i=0}=this.shapeArgs||{};return[["M",e-t,r-t],["L",e-t,r+i+t],["L",e+a+t,r+i+t],["L",e+a+t,r-t],["Z"]]}isValid(){return this.value!==1/0&&this.value!==-1/0}}f(v.prototype,{dataLabelOnNull:!0,moveToTopOnHover:!0,ttBelow:!1});let M=a()["isNumber"],A=t.default.SVGRenderer;var k=r.n(A);let C=a()["doc"],{defined:w,pick:P}=a(),{series:T,seriesTypes:{column:D,scatter:O}}=n(),{symbols:G}=k()["prototype"],{addEvent:R,extend:L,fireEvent:E,isNumber:N,merge:S,pick:V}=a(),{colorFromPoint:W,getContext:F}={colorFromPoint:function(e,r){let a=r.series.colorAxis;if(a){let t=a.toColor(e||0,r).split(")")[0].split("(")[1].split(",").map(t=>P(parseFloat(t),parseInt(t,10)));return t[3]=255*P(t[3],1),w(e)&&r.visible||(t[3]=0),t}return[0,0,0,0]},getContext:function(t){let{canvas:e,context:r}=t;return e&&r?(r.clearRect(0,0,e.width,e.height),r):(t.canvas=C.createElement("canvas"),t.context=t.canvas.getContext("2d",{willReadFrequently:!0})||void 0,t.context)}};class I extends O{constructor(){super(...arguments),this.valueMax=NaN,this.valueMin=NaN,this.isDirtyCanvas=!0}drawPoints(){let P=this,t=P.options,e=t.interpolation,r=t.marker||{};if(e){let{image:f,chart:M,xAxis:A,yAxis:k}=P,{reversed:w=!1,len:t}=A,{reversed:C=!1,len:e}=k,T={width:t,height:e};if(!f||P.isDirtyData||P.isDirtyCanvas){let m=F(P),{canvas:g,options:{colsize:y=1,rowsize:v=1},points:x,points:{length:b}}=P,t=M.colorAxis&&M.colorAxis[0];if(g&&m&&t){let{min:e,max:t}=A.getExtremes(),{min:r,max:a}=k.getExtremes(),i=t-e,s=a-r,o=Math.round(i/y/8*8),l=Math.round(s/v/8*8),[n,h]=[[o,o/i,w,"ceil"],[l,l/s,!C,"floor"]].map(([e,r,t,a])=>t?t=>Math[a](e-r*t):t=>Math[a](r*t)),p=g.width=o+1,d=p*(g.height=l+1),u=(b-1)/d,c=new Uint8ClampedArray(4*d);P.buildKDTree();for(let t=0;t<d;t++){var G=x[Math.ceil(u*t)],{x:O,y:D}=G;c.set(W(G.value,G),(G=O,4*Math.ceil(p*h(D-r)+n(G-e))))}m.putImageData(new ImageData(c,p),0,0),f?f.attr({...T,href:g.toDataURL("image/png",1)}):(P.directTouch=!1,P.image=M.renderer.image(g.toDataURL("image/png",1)).attr(T).add(P.group))}P.isDirtyCanvas=!1}else f.width===t&&f.height===e||f.attr(T)}else(r.enabled||P._hasPointMarkers)&&(T.prototype.drawPoints.call(P),P.points.forEach(t=>{t.graphic&&(t.graphic[P.chart.styledMode?"css":"animate"](P.colorAttribs(t)),null===t.value&&t.graphic.addClass("highcharts-null-point"))}))}getExtremes(){var{dataMin:t,dataMax:e}=T.prototype.getExtremes.call(this,this.getColumn("value"));return N(t)&&(this.valueMin=t),N(e)&&(this.valueMax=e),T.prototype.getExtremes.call(this)}getValidPoints(t,e){return T.prototype.getValidPoints.call(this,t,e,!0)}hasData(){return!!this.dataTable.rowCount}init(){super.init.apply(this,arguments);let t=this.options;t.pointRange=V(t.pointRange,t.colsize||1),this.yAxis.axisPointRange=t.rowsize||1,G.ellipse=G.circle,t.marker&&N(t.borderRadius)&&(t.marker.r=t.borderRadius)}markerAttribs(t,e){var r,a=t.shapeArgs||{};return t.hasImage?{x:t.plotX,y:t.plotY}:e&&"normal"!==e?(t=t.options.marker||{},r=(this.options.marker||{}).states?.[e]||{},e=((t=t.states?.[e]||{}).width||r.width||a.width||0)+(t.widthPlus||r.widthPlus||0),t=(t.height||r.height||a.height||0)+(t.heightPlus||r.heightPlus||0),{x:(a.x||0)+((a.width||0)-e)/2,y:(a.y||0)+((a.height||0)-t)/2,width:e,height:t}):a}pointAttribs(t,e){let r=T.prototype.pointAttribs.call(this,t,e),a=this.options||{},i=this.chart.options.plotOptions||{},s=i.series||{},l=i.heatmap||{},n=t?.options.borderColor||a.borderColor||l.borderColor||s.borderColor,h=t?.options.borderWidth||a.borderWidth||l.borderWidth||s.borderWidth||r["stroke-width"];return r.stroke=t?.marker?.lineColor||a.marker?.lineColor||n||this.color,r["stroke-width"]=h,e&&"normal"!==e&&(t=S(a.states?.[e],a.marker?.states?.[e],t?.options.states?.[e]||{}),r.fill=t.color||o().parse(r.fill).brighten(t.brightness||0).get(),r.stroke=t.lineColor||r.stroke),r}translate(){let{borderRadius:s,marker:t}=this.options,o=t?.symbol||"rect",l=G[o]?o:"rect",n=-1!==["circle","square"].indexOf(l);for(var h of(this.generatePoints(),this.points)){let t=h.getCellAttributes(),e=Math.min(t.x1,t.x2),r=Math.min(t.y1,t.y2),a=Math.max(Math.abs(t.x2-t.x1),0),i=Math.max(Math.abs(t.y2-t.y1),0);var p;h.hasImage=0===(h.marker?.symbol||o||"").indexOf("url"),n&&(p=Math.abs(a-i),e=Math.min(t.x1,t.x2)+(a<i?0:p/2),r=Math.min(t.y1,t.y2)+(a<i?p/2:0),a=i=Math.min(a,i)),h.hasImage&&(h.marker={width:a,height:i}),h.plotX=h.clientX=(t.x1+t.x2)/2,h.plotY=(t.y1+t.y2)/2,h.shapeType="path",h.shapeArgs=S(!0,{x:e,y:r,width:a,height:i},{d:G[l](e,r,a,i,{r:N(s)?s:0})})}E(this,"afterTranslate")}}I.defaultOptions=S(O.defaultOptions,{animation:!1,borderRadius:0,borderWidth:0,interpolation:!1,nullColor:"#f7f7f7",dataLabels:{formatter:function(){let t=this.series.chart["numberFormatter"],e=this.point["value"];return M(e)?t(e,-1):""},inside:!0,verticalAlign:"middle",crop:!1,overflow:"allow",padding:0},marker:{symbol:"rect",radius:0,lineColor:void 0,states:{hover:{lineWidthPlus:0},select:{}}},clip:!0,pointRange:null,tooltip:{pointFormat:"{point.x}, {point.y}: {point.value}<br/>"},states:{hover:{halo:!1,brightness:.2}},legendSymbol:"rectangle"}),R(I,"afterDataClassLegendClick",function(){this.isDirtyCanvas=!0,this.drawPoints()}),L(I.prototype,{axisTypes:m.seriesMembers.axisTypes,colorKey:m.seriesMembers.colorKey,directTouch:!0,getExtremesFromAll:!0,keysAffectYAxis:["y"],parallelArrays:m.seriesMembers.parallelArrays,pointArrayMap:["y","value"],pointClass:v,specialGroup:"group",trackerGroups:m.seriesMembers.trackerGroups,alignDataLabel:D.prototype.alignDataLabel,colorAttribs:m.seriesMembers.colorAttribs,getSymbol:T.prototype.getSymbol}),m.compose(I),n().registerSeriesType("heatmap",I);let j=a();export{j as default};