import*as t from"../highcharts.js";var e={n:t=>{var i=t&&t.__esModule?()=>t.default:()=>t;return e.d(i,{a:i}),i},d:(t,i)=>{for(var o in i)e.o(i,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:i[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};let i=t.default;var o=e.n(i);let n={draw:function(e,t){let{animatableAttribs:i,onComplete:o,css:n,renderer:r}=t,a=e.series&&e.series.chart.hasRendered?void 0:e.series&&e.series.options.animation,l=e.graphic;if(t.attribs={...t.attribs,class:e.getClassName()},e.shouldDraw())l||(e.graphic=l="text"===t.shapeType?r.text():"image"===t.shapeType?r.image(t.imageUrl||"").attr(t.shapeArgs||{}):r[t.shapeType](t.shapeArgs||{}),l.add(t.group)),n&&l.css(n),l.attr(t.attribs).animate(i,!t.isNew&&a,o);else if(l){let t=()=>{e.graphic=l=l&&l.destroy(),"function"==typeof o&&o()};Object.keys(i).length?l.animate(i,void 0,()=>t()):t()}}},r=t.default.SeriesRegistry;var a=e.n(r);let{prototype:{pointClass:l}}=a().seriesTypes["column"],s=o()["extend"];class h extends l{isValid(){return!0}}s(h.prototype,{weight:1});let d=o()["deg2rad"],{extend:p,find:g,isNumber:u,isObject:c,merge:m}=o();function f(t,e){return!(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)}function x(t){let e,n=t.axes||[];return n.length||(n=[],(e=t.concat([t[0]])).reduce((t,e)=>{o=e[0]-t[0];let i=[-(e[1]-t[1]),o];var o;return g(n,t=>t[0]===i[0]&&t[1]===i[1])||n.push(i),e}),t.axes=n),n}function y(t,i){t=t.map(t=>{var e=t[0],t=t[1];return e*i[0]+t*i[1]});return{min:Math.min.apply(this,t),max:Math.max.apply(this,t)}}function b(o,n){let t=x(o),e=x(n);return!g(t.concat(e),t=>{var e=n,i=y(o,t);return!!((e=y(e,t)).min>i.max||e.max<i.min)})}function M(t,e){let i=4*t,o=Math.ceil((Math.sqrt(i)-1)/2),n=2*o+1,r=Math.pow(n,2),a=!1;return--n,t<=1e4&&("boolean"==typeof a&&i>=r-n&&(a={x:o-(r-i),y:-o}),r-=n,"boolean"==typeof a&&i>=r-n&&(a={x:-o,y:-o+(r-i)}),r-=n,(a="boolean"==typeof a?i>=r-n?{x:-o+(r-i),y:o}:{x:o,y:o-(r-i-n)}:a).x*=5,a.y*=5),a}function w(t,e){e=Math.pow(10,u(e)?e:14);return Math.round(t*e)/e}function S(t,e){var i=t[0],t=t[1],e=-d*e,o=Math.cos(e),e=Math.sin(e);return[w(i*o-t*e),w(i*e+t*o)]}function F(t,e,i){t=S([t[0]-e[0],t[1]-e[1]],i);return[t[0]+e[0],t[1]+e[1]]}let P=o()["noop"],A=a().seriesTypes["column"],{extend:T,isArray:v,isNumber:z,isObject:X,merge:B}=o(),{archimedeanSpiral:C,extendPlayingField:W,getBoundingBoxFromPolygon:N,getPlayingField:O,getPolygon:D,getRandomPosition:R,getRotation:Y,getScale:_,getSpiral:E,intersectionTesting:L,isPolygonsColliding:j,rectangularSpiral:H,rotate2DToOrigin:U,rotate2DToPoint:V,squareSpiral:q,updateFieldBoundaries:k}={archimedeanSpiral:function(t,e){let i=e.field,o=i.width*i.width+i.height*i.height,n=.8*t,r=!1;return r=t<=1e4&&!(Math.min(Math.abs((r={x:n*Math.cos(n),y:n*Math.sin(n)}).x),Math.abs(r.y))<o)?!1:r},extendPlayingField:function(t,e){let i,o,n,r,a,l;return l=c(t)&&c(e)?(i=e.bottom-e.top,a=(o=e.right-e.left)*(n=t.ratioX)>i*(r=t.ratioY)?o:i,m(t,{width:t.width+a*n*2,height:t.height+a*r*2})):t},getBoundingBoxFromPolygon:function(t){return t.reduce(function(t,e){var i=e[0],e=e[1];return t.left=Math.min(i,t.left),t.right=Math.max(i,t.right),t.bottom=Math.max(e,t.bottom),t.top=Math.min(e,t.top),t},{left:Number.MAX_VALUE,right:-Number.MAX_VALUE,bottom:-Number.MAX_VALUE,top:Number.MAX_VALUE})},getPlayingField:function(t,e,i){var i=i.reduce(function(t,e){var e=e.dimensions,i=Math.max(e.width,e.height);return t.maxHeight=Math.max(t.maxHeight,e.height),t.maxWidth=Math.max(t.maxWidth,e.width),t.area+=i*i,t},{maxHeight:0,maxWidth:0,area:0}),i=Math.max(i.maxHeight,i.maxWidth,.85*Math.sqrt(i.area)),o=e<t?t/e:1,e=t<e?e/t:1;return{width:i*o,height:i*e,ratioX:o,ratioY:e}},getPolygon:function(t,e,i,o,n){let r=[t,e],a=t-i/2,l=t+i/2,s=e-o/2,h=e+o/2;return[[a,s],[l,s],[l,h],[a,h]].map(function(t){return F(t,r,-n)})},getRandomPosition:function(t){return Math.round(t*(Math.random()+.5)/2)},getRotation:function(t,e,i,o){let n=!1;return n=u(t)&&u(e)&&u(i)&&u(o)&&0<t&&-1<e&&i<o?i+e%t*((o-i)/(t-1||1)):n},getScale:function(t,e,i){var o=2*Math.max(Math.abs(i.top),Math.abs(i.bottom)),i=2*Math.max(Math.abs(i.left),Math.abs(i.right));return Math.min(0<i?1/i*t:1,0<o?1/o*e:1)},getSpiral:function(e,i){let o=[];for(let t=1;t<1e4;t++)o.push(e(t,i));return t=>t<=1e4&&o[t-1]},intersectionTesting:function(t,e){let i=e.placed,r=e.field,o=e.rectangle,n=e.polygon,a=e.spiral,l=t.rect=p({},o),s=1,h={x:0,y:0};for(t.polygon=n,t.rotation=e.rotation;!1!==h&&(function(i,t){function o(t){let e=f(n,t.rect);return e=e&&(i.rotation%90||t.rotation%90)?b(r,t.polygon):e}let n=i.rect,r=i.polygon,e=i.lastCollidedWith,a=!1;return e&&!(a=o(e))&&delete i.lastCollidedWith,a=a||!!g(t,function(t){var e=o(t);return e&&(i.lastCollidedWith=t),e})}(t,i)||function(t){let e=-r.width/2,i=r.width/2,o=-r.height/2,n=r.height/2;return!(e<t.left&&i>t.right&&o<t.top&&n>t.bottom)}(l));)c(h=a(s))&&(l.left=o.left+h.x,l.right=o.right+h.x,l.top=o.top+h.y,l.bottom=o.bottom+h.y,t.polygon=function(e,i){return n.map(function(t){return[t[0]+e,t[1]+i]})}(h.x,h.y)),s++;return h},isPolygonsColliding:b,rectangularSpiral:function(t,e){let i=M(t,e),o=e.field;return i&&(i.x*=o.ratioX,i.y*=o.ratioY),i},rotate2DToOrigin:S,rotate2DToPoint:F,squareSpiral:M,updateFieldBoundaries:function(t,e){return(!u(t.left)||t.left>e.left)&&(t.left=e.left),(!u(t.right)||t.right<e.right)&&(t.right=e.right),(!u(t.top)||t.top>e.top)&&(t.top=e.top),(!u(t.bottom)||t.bottom<e.bottom)&&(t.bottom=e.bottom),t}};class I extends A{pointAttribs(t,e){let i=o().seriesTypes.column.prototype.pointAttribs.call(this,t,e);return delete i.stroke,delete i["stroke-width"],i}deriveFontSize(t,e,i){t=z(t)?t:0,e=z(e)?e:1;return Math.floor(Math.max(z(i)?i:1,t*e))}drawPoints(){let h=this.hasRendered,t=this.xAxis,e=this.yAxis,i=this.chart,d=this.group,p=this.options,u=p.animation,g=p.allowExtendPlayingField,c=i.renderer,m=[],f=this.placementStrategy[p.placementStrategy],y=p.rotation,o=this.points.map(function(t){return t.weight}),x=Math.max.apply(null,o),b=this.points.concat().sort((t,e)=>e.weight-t.weight),r=c.text().add(d),M;for(var a of(this.group.attr({scaleX:1,scaleY:1}),b)){var l=1/x*a.weight,l=T({fontSize:this.deriveFontSize(l,p.maxFontSize,p.minFontSize)+"px"},p.style),l=(r.css(l).attr({x:0,y:0,text:a.name}),r.getBBox(!0));a.dimensions={height:l.height,width:l.width}}M=O(t.len,e.len,b);var w,v=E(this.spirals[p.spiral],{field:M});for(w of b){let t=1/x*w.weight,e=T({fontSize:this.deriveFontSize(t,p.maxFontSize,p.minFontSize)+"px"},p.style),i=f(w,{data:b,field:M,placed:m,rotation:y}),o=T(this.pointAttribs(w,w.selected&&"select"),{align:"center","alignment-baseline":"middle","dominant-baseline":"middle",x:i.x,y:i.y,text:w.name,rotation:z(i.rotation)?i.rotation:void 0}),r=D(i.x,i.y,w.dimensions.width,w.dimensions.height,i.rotation),a=N(r),l=L(w,{rectangle:a,polygon:r,field:M,placed:m,spiral:v,rotation:i.rotation}),s;!l&&g&&(M=W(M,a),l=L(w,{rectangle:a,polygon:r,field:M,placed:m,spiral:v,rotation:i.rotation})),X(l)?(o.x=(o.x||0)+l.x,o.y=(o.y||0)+l.y,a.left+=l.x,a.right+=l.x,a.top+=l.y,a.bottom+=l.y,M=k(M,a),m.push(w),w.isNull=!1,w.isInside=!0):w.isNull=!0,u&&(s={x:o.x,y:o.y},h?(delete o.x,delete o.y):(o.x=0,o.y=0)),n.draw(w,{animatableAttribs:s,attribs:o,css:e,group:d,renderer:c,shapeArgs:void 0,shapeType:"text"})}r=r.destroy();var s=_(t.len,e.len,M);this.group.attr({scaleX:s,scaleY:s})}hasData(){return X(this)&&!0===this.visible&&v(this.points)&&0<this.points.length}getPlotBox(){var t=this.chart,e=t.inverted,i=this[e?"yAxis":"xAxis"],e=this[e?"xAxis":"yAxis"],o=i?i.len:t.plotWidth,n=e?e.len:t.plotHeight;return{translateX:(i?i.left:t.plotLeft)+o/2,translateY:(e?e.top:t.plotTop)+n/2,scaleX:1,scaleY:1}}}I.defaultOptions=B(A.defaultOptions,{allowExtendPlayingField:!0,animation:{duration:500},borderWidth:0,clip:!1,colorByPoint:!0,cropThreshold:1/0,minFontSize:1,maxFontSize:25,placementStrategy:"center",rotation:{from:0,orientations:2,to:90},showInLegend:!1,spiral:"rectangular",style:{fontFamily:"sans-serif",fontWeight:"900",whiteSpace:"nowrap"},tooltip:{followPointer:!0,pointFormat:'<span style="color:{point.color}">‚óè</span> {series.name}: <b>{point.weight}</b><br/>'}}),T(I.prototype,{animate:P,animateDrilldown:P,animateDrillupFrom:P,isCartesian:!1,pointClass:h,setClip:P,placementStrategy:{random:function(t,e){var i=e.field,e=e.rotation;return{x:R(i.width)-i.width/2,y:R(i.height)-i.height/2,rotation:Y(e.orientations,t.index,e.from,e.to)}},center:function(t,e){e=e.rotation;return{x:0,y:0,rotation:Y(e.orientations,t.index,e.from,e.to)}}},pointArrayMap:["weight"],spirals:{archimedean:C,rectangular:H,square:q},utils:{extendPlayingField:W,getRotation:Y,isPolygonsColliding:j,rotate2DToOrigin:U,rotate2DToPoint:V}}),a().registerSeriesType("wordcloud",I);let G=o();export{G as default};