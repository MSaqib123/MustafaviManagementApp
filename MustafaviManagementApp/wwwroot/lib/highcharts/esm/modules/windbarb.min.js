import*as t from"../highcharts.js";import*as e from"./datagrouping.js";var o,r={n:t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},d:(t,e)=>{for(var o in e)r.o(e,o)&&!r.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};let i=t.default;var s=r.n(i);let a=e.default.dataGrouping.approximations;var l=r.n(a);let n=t.default.Series.types.column;var p=r.n(n);let h=t.default.Series;var u=r.n(h);let d=s()["composed"],c=p()["prototype"],f=u()["prototype"],{defined:g,pushUnique:b,stableSort:x}=s(),y=(!function(t){function o(t){return f.getPlotBox.call(this.options.onSeries&&this.chart.get(this.options.onSeries)||this,t)}function r(){c.translate.apply(this);let r=this,t=r.options,e=r.chart,i=r.points,o=t.onSeries,s=o&&e.get(o),a=s&&s.options.step,n=s&&s.points,l=e.inverted,p=r.xAxis,h=r.yAxis,u=i.length-1,d,f,b=t.onKey||"y",y=n&&n.length,v=0,m,L,S,X,k;if(s&&s.visible&&y)for(v=(s.pointXOffset||0)+(s.barW||0)/2,X=s.currentDataGrouping,L=n[y-1].x+(X?X.totalRange:0),x(i,(t,e)=>t.x-e.x),b="plot"+b[0].toUpperCase()+b.substr(1);y--&&i[u];)if(m=n[y],(d=i[u]).y=m.y,m.x<=d.x&&void 0!==m[b]){if(d.x<=L&&(d.plotY=m[b],m.x<d.x&&!a&&(S=n[y+1])&&void 0!==S[b]))if(g(d.plotX)&&s.is("spline")){let o=[m.plotX||0,m.plotY||0],r=[S.plotX||0,S.plotY||0],i=m.controlPoints?.high||o,s=S.controlPoints?.low||r,e=(t,e)=>Math.pow(1-t,3)*o[e]+3*(1-t)*(1-t)*t*i[e]+3*(1-t)*t*t*s[e]+t*t*t*r[e],a=0,n=1,l;for(let t=0;t<100;t++){var P=(a+n)/2,w=e(P,0);if(null===w)break;if(Math.abs(w-d.plotX)<.25){l=P;break}w<d.plotX?a=P:n=P}g(l)&&(d.plotY=e(l,1),d.y=h.toValue(d.plotY,!0))}else k=(d.x-m.x)/(S.x-m.x),d.plotY+=k*(S[b]-m[b]),d.y+=k*(S.y-m.y);if(u--,y++,u<0)break}i.forEach((t,e)=>{let o;t.plotX+=v,void 0!==t.plotY&&!l||(0<=t.plotX&&t.plotX<=p.len?l?(t.plotY=p.translate(t.x,0,1,0,1),t.plotX=g(t.y)?h.translate(t.y,0,0,0,1):0):t.plotY=(p.opposite?0:r.yAxis.len)+p.offset:t.shapeArgs={}),(f=i[e-1])&&f.plotX===t.plotX&&(void 0===f.stackIndex&&(f.stackIndex=0),o=f.stackIndex+1),t.stackIndex=o}),this.onSeries=s}t.compose=function(e){if(b(d,"OnSeries")){let t=e.prototype;t.getPlotBox=o,t.translate=r}return e},t.getPlotBox=o,t.translate=r}(o=o||{}),o),v=t.default.SeriesRegistry;var m=r.n(v);let L=s()["isNumber"];class w extends p().prototype.pointClass{isValid(){return L(this.value)&&0<=this.value}}let S=s()["animObject"],X=m().seriesTypes["column"],{extend:k,merge:M,pick:O}=s();class P extends X{init(t,e){super.init(t,e)}pointAttribs(t,e){let o=this.options,r=t.color||this.color,i=this.options.lineWidth;return e&&(r=o.states[e].color||r,i=(o.states[e].lineWidth||i)+(o.states[e].lineWidthPlus||0)),{stroke:r,"stroke-width":i}}windArrow(t){let e=t.beaufortLevel,o=this.options.vectorLength/20,r=1.943844*t.value,i,s=-10;if(t.isNull)return[];if(0===e)return this.chart.renderer.symbols.circle(-10*o,-10*o,20*o,20*o);let a=[["M",0,7*o],["L",-1.5*o,7*o],["L",0,10*o],["L",1.5*o,7*o],["L",0,7*o],["L",0,-10*o]];if(0<(i=(r-r%50)/50))for(;i--;)a.push(-10===s?["L",0,s*o]:["M",0,s*o],["L",5*o,s*o+2],["L",0,s*o+4]),r-=50,s+=7;if(0<(i=(r-r%10)/10))for(;i--;)a.push(-10===s?["L",0,s*o]:["M",0,s*o],["L",7*o,s*o]),r-=10,s+=3;if(0<(i=(r-r%5)/5))for(;i--;)a.push(-10===s?["L",0,s*o]:["M",0,s*o],["L",4*o,s*o]),r-=5,s+=3;return a}drawPoints(){let t=this.chart,e=this.yAxis,o=t.inverted,r=this.options.vectorLength/2;for(var i of this.points){var s=i.plotX,a=i.plotY;!1===this.options.clip||t.isInsidePlot(s,0)?(i.graphic||(i.graphic=this.chart.renderer.path().add(this.markerGroup).addClass("highcharts-point highcharts-color-"+O(i.colorIndex,i.series.colorIndex))),i.graphic.attr({d:this.windArrow(i),translateX:s+this.options.xOffset,translateY:a+this.options.yOffset,rotation:i.direction}),this.chart.styledMode||i.graphic.attr(this.pointAttribs(i))):i.graphic&&(i.graphic=i.graphic.destroy()),i.tooltipPos=[s+this.options.xOffset+(o&&!this.onSeries?r:0),a+this.options.yOffset-(o?0:r+e.pos-t.plotTop)]}}animate(t){t?this.markerGroup.attr({opacity:.01}):this.markerGroup.animate({opacity:1},S(this.options.animation))}markerAttribs(){return{}}getExtremes(){return{}}shouldShowTooltip(t,e,o={}){return o.ignoreX=this.chart.inverted,o.ignoreY=!o.ignoreX,super.shouldShowTooltip(t,e,o)}}P.defaultOptions=M(X.defaultOptions,{dataGrouping:{enabled:!0,approximation:"windbarb",groupPixelWidth:30},lineWidth:2,onSeries:null,states:{hover:{lineWidthPlus:0}},tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span> {series.name}: <b>{point.value}</b> ({point.beaufort})<br/>'},vectorLength:20,colorKey:"value",yOffset:-20,xOffset:0}),y.compose(P),k(P.prototype,{beaufortFloor:[0,.3,1.6,3.4,5.5,8,10.8,13.9,17.2,20.8,24.5,28.5,32.7],beaufortName:["Calm","Light air","Light breeze","Gentle breeze","Moderate breeze","Fresh breeze","Strong breeze","Near gale","Gale","Strong gale","Storm","Violent storm","Hurricane"],invertible:!1,parallelArrays:["x","value","direction"],pointArrayMap:["value","direction"],pointClass:w,trackerGroups:["markerGroup"],translate:function(){var e,o=this.beaufortFloor,r=this.beaufortName;for(e of(y.translate.call(this),this.points)){let t=0;for(;t<o.length&&!(o[t]>e.value);t++);e.beaufortLevel=t-1,e.beaufort=r[t-1]}}}),m().registerSeriesType("windbarb",P),l().windbarb||(l().windbarb=(o,r)=>{let i=0,a=0;for(let t=0,e=o.length;t<e;t++)i+=o[t]*Math.cos(r[t]*s().deg2rad),a+=o[t]*Math.sin(r[t]*s().deg2rad);return[o.reduce((t,e)=>t+e,0)/o.length,Math.atan2(a,i)/s().deg2rad]});let A=s();export{A as default};