!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(t._Highcharts,t._Highcharts.AST):"function"==typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts/highcharts"],function(t){return e(t,t.AST)}):"object"==typeof exports?exports["highcharts/modules/export-data"]=e(t._Highcharts,t._Highcharts.AST):t.Highcharts=e(t.Highcharts,t.Highcharts.AST)}("undefined"==typeof window?this:window,(K,W)=>(()=>{"use strict";var a={660:t=>{t.exports=W},944:t=>{t.exports=K}},o={};function n(t){var e=o[t];if(void 0!==e)return e.exports;e=o[t]={exports:{}};return a[t](e,e.exports,n),e.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var t={},e=(n.d(t,{default:()=>P}),n(944)),e=n.n(e);let{isSafari:i,win:r,win:{document:s}}=e(),l=r.URL||r.webkitURL||r;function h(o){o=o.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([A-Z+\d\/]+)/i);if(o&&3<o.length&&r.atob&&r.ArrayBuffer&&r.Uint8Array&&r.Blob&&l.createObjectURL){let e=r.atob(o[3]),t=new r.ArrayBuffer(e.length),a=new r.Uint8Array(t);for(let t=0;t<a.length;++t)a[t]=e.charCodeAt(t);return l.createObjectURL(new r.Blob([a],{type:o[1]}))}}var d={dataURLtoBlob:h,downloadURL:function(t,e){let a=r.navigator,o=s.createElement("a");if("string"==typeof t||t instanceof String||!a.msSaveOrOpenBlob){if(t=""+t,1e3<a.userAgent.length)throw Error("Input too long");var n=/Edge\/\d+/.test(a.userAgent);if((i&&"string"==typeof t&&0===t.indexOf("data:application/pdf")||n||2e6<t.length)&&!(t=h(t)||""))throw Error("Failed to convert to blob");if(void 0!==o.download)o.href=t,o.download=e,s.body.appendChild(o),o.click(),s.body.removeChild(o);else try{if(!r.open(t,"chart"))throw Error("Failed to open window")}catch{r.location.href=t}}else a.msSaveOrOpenBlob(t,e)}},c=n(660),p=n.n(c);let u={exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0,showExportInProgress:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table",hideData:"Hide data table",exportInProgress:"Exporting..."}},{getOptions:g,setOptions:f}=e(),m=d["downloadURL"],{doc:x,win:b}=e(),{addEvent:y,defined:E,extend:w,find:A,fireEvent:C,isNumber:O,pick:k}=e();function v(t){let e=!!this.options.exporting?.showExportInProgress,a=b.requestAnimationFrame||setTimeout;a(()=>{e&&this.showLoading(this.options.lang.exportInProgress),a(()=>{try{t.call(this)}finally{e&&this.hideLoading()}})})}function T(){v.call(this,()=>{var t=this.getCSV(!0);m(V(t,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(t),this.getFilename()+".csv")})}function D(){v.call(this,()=>{var t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";m(V(t,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+b.btoa(unescape(encodeURIComponent(t))),this.getFilename()+".xls")})}function S(t){let n="",i=this.getDataRows(),e=this.options.exporting.csv,r=k(e.decimalPoint,","!==e.itemDelimiter&&t?1.1.toLocaleString()[1]:"."),s=k(e.itemDelimiter,","===r?";":","),l=e.lineDelimiter;return i.forEach((t,e)=>{let a="",o=t.length;for(;o--;)"number"==typeof(a="string"==typeof(a=t[o])?`"${a}"`:a)&&"."!==r&&(a=a.toString().replace(".",r)),t[o]=a;t.length=i.length?i[0].length:0,n+=t.join(s),e<i.length-1&&(n+=l)}),n}function L(n){function i(t,e,a){if(y.columnHeaderFormatter){var o=y.columnHeaderFormatter(t,e,a);if(!1!==o)return o}return t?t.bindAxes?n?{columnTitle:1<a?e:t.name,topLevelColumnTitle:t.name}:t.name+(1<a?" ("+e+")":""):t.options.title&&t.options.title.text||(t.dateTime?l:s):s}function m(a,t,o){let n={},i={};return t.forEach(function(t){var e=(a.keyToAxis&&a.keyToAxis[t]||t)+"Axis",e=O(o)?a.chart[e][o]:a[e];n[t]=e&&e.categories||[],i[t]=e&&e.dateTime}),{categoryMap:n,dateTimeValueAxisMap:i}}let a,o,x=this.hasParallelCoordinates,b=this.time,y=this.options.exporting&&this.options.exporting.csv||{},r=this.xAxis,w={},t=[],v=[],T=[],e=this.options.lang.exportData,s=e.categoryHeader,l=e.categoryDatetimeHeader,D=[],h,d,S,L=0,c,p;for(c in this.series.forEach(function(s){let t=s.options.keys,l=s.xAxis,h=t||(a=l,o=(e=s).pointArrayMap||["y"],e.data.some(t=>void 0!==t.y&&t.name)&&a&&!a.categories&&"name"!==e.exportKey?["x",...o]:o),d=h.length,c=!s.requireSorting&&{},p=r.indexOf(l),u=m(s,h),g,f;var e,a,o;if(!1!==s.options.includeInDataExport&&!s.options.isInternal&&!1!==s.visible){for(A(D,function(t){return t[0]===p})||D.push([p,L]),f=0;f<d;)S=i(s,h[f],h.length),T.push(S.columnTitle||S),n&&v.push(S.topLevelColumnTitle||S),f++;g={chart:s.chart,autoIncrement:s.autoIncrement,options:s.options,pointArrayMap:s.pointArrayMap,index:s.index},s.options.data.forEach(function(t,e){let a,o,n,i={series:g};x&&(u=m(s,h,e)),s.pointClass.prototype.applyOptions.apply(i,[t]);t=s.data[e]&&s.data[e].name;if(a=(i.x??"")+","+t,f=0,(!l||"name"===s.exportKey||!x&&l&&l.hasNames&&t)&&(a=t),c&&(c[a]&&(a+="|"+e),c[a]=!0),w[a]){var e=a+","+w[a].pointers[s.index],r=a;w[a].pointers[s.index]&&(w[e]||(w[e]=[],w[e].xValues=[],w[e].pointers=[]),a=e),w[r].pointers[s.index]+=1}else{w[a]=[],w[a].xValues=[];let e=[];for(let t=0;t<s.chart.series.length;t++)e[t]=0;w[a].pointers=e,w[a].pointers[s.index]=1}for(w[a].x=i.x,w[a].name=t,w[a].xValues[p]=i.x;f<d;)o=h[f],n=s.pointClass.prototype.getNestedProperty.apply(i,[o]),w[a][L+f]=k(u.categoryMap[o][n],u.dateTimeValueAxisMap[o]?b.dateFormat(y.dateFormat,n):null,n),f++}),L+=f}}),w)Object.hasOwnProperty.call(w,c)&&t.push(w[c]);for(d=n?[v,T]:[T],L=D.length;L--;)a=D[L][0],o=D[L][1],h=r[a],t.sort(function(t,e){return t.xValues[a]-e.xValues[a]}),p=i(h),d[0].splice(o,0,p),n&&d[1]&&d[1].splice(o,0,p),t.forEach(function(t){let e=t.name;h&&!E(e)&&(e=h.dateTime?(t.x instanceof Date&&(t.x=t.x.getTime()),b.dateFormat(y.dateFormat,t.x)):h.categories?k(h.names[t.x],h.categories[t.x],t.x):t.x),t.splice(o,0,e)});return C(this,"exportData",{dataRows:d=d.concat(t)}),d}function H(t){let e=t=>{if(!t.tagName||"#text"===t.tagName)return t.textContent||"";let a=t.attributes,o="<"+t.tagName;return a&&Object.keys(a).forEach(t=>{var e=a[t];o+=` ${t}="${e}"`}),o=(o+=">")+(t.textContent||""),(t.children||[]).forEach(t=>{o+=e(t)}),o+=`</${t.tagName}>`};return e(this.getTableAST(t))}function R(t){function h(t,e,a,o){let n=k(o,""),i="highcharts-text"+(e?" "+e:"");return"number"==typeof n?(n=n.toString(),","===r&&(n=n.replace(".",r)),i="highcharts-number"):o||(i="highcharts-empty"),{tagName:t,attributes:a=w({class:i},a),textContent:n}}let d=0,e=[],c=this.options,r=t?1.1.toLocaleString()[1]:".",p=k(c.exporting.useMultiLevelHeaders,!0),a=this.getDataRows(p),o=p?a.shift():null,u=a.shift(),n=(c.exporting||{})["tableCaption"];!1!==n&&e.push({tagName:"caption",attributes:{class:"highcharts-table-caption"},textContent:"string"==typeof n?n:c.title?.text||c.lang.chartTitle});for(let t=0,e=a.length;t<e;++t)a[t].length>d&&(d=a[t].length);e.push(function(t,a){let o=[],n=0,i=Math.max(d,u.length)||a&&a.length,r,s=0,l;if(p&&t&&a&&!function(t,e){let a=t.length;if(e.length!==a)return!1;for(;a--;)if(t[a]!==e[a])return!1;return!0}(t,a)){let e=[];for(;n<i;++n)if((r=t[n])===t[n+1])++s;else if(s)e.push(h("th","highcharts-table-topheading",{scope:"col",colspan:s+1},r)),s=0;else{r===a[n]?c.exporting.useRowspanHeaders?(l=2,delete a[n]):(l=1,a[n]=""):l=1;let t=h("th","highcharts-table-topheading",{scope:"col"},r);1<l&&t.attributes&&(t.attributes.valign="top",t.attributes.rowspan=l),e.push(t)}o.push({tagName:"tr",children:e})}if(a){let t=[];for(n=0,i=a.length;n<i;++n)void 0!==a[n]&&t.push(h("th",null,{scope:"col"},a[n]));o.push({tagName:"tr",children:t})}return{tagName:"thead",children:o}}(o,u));let i=[];a.forEach(function(e){let a=[];for(let t=0;t<d;t++)a.push(h(t?"td":"th",null,t?{}:{scope:"row"},e[t]));i.push({tagName:"tr",children:a})}),e.push({tagName:"tbody",children:i});t={tree:{tagName:"table",id:"highcharts-data-table-"+this.index,children:e}};return C(this,"aftergetTableAST",t),t.tree}function N(){this.toggleDataTable(!1)}function U(a){var o=(a=k(a,!this.isDataTableVisible))&&!this.dataTableDiv;if(o&&(this.dataTableDiv=x.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv){let t=this.dataTableDiv.style,e=t.display;t.display=a?"block":"none",a?(this.dataTableDiv.innerHTML=p().emptyHTML,new(p())([this.getTableAST()]).addToDOM(this.dataTableDiv),C(this,"afterViewData",{element:this.dataTableDiv,wasHidden:o||e!==t.display})):C(this,"afterHideData")}this.isDataTableVisible=a;let t=this.exportDivElements,e=this.options.exporting,n=e&&e.buttons&&e.buttons.contextButton.menuItems,i=this.options.lang;e&&e.menuItemDefinitions&&i&&i.viewData&&i.hideData&&n&&t&&((o=t[n.indexOf("viewData")])&&p().setElementHTML(o,this.isDataTableVisible?i.hideData:i.viewData))}function I(){this.toggleDataTable(!0)}function V(e,t){let a=b.navigator,o=b.URL||b.webkitURL||b;try{if(a.msSaveOrOpenBlob&&b.MSBlobBuilder){let t=new b.MSBlobBuilder;return t.append(e),t.getBlob("image/svg+xml")}return o.createObjectURL(new b.Blob(["\ufeff"+e],{type:t}))}catch(e){}}function M(){let r=this,s=r.dataTableDiv,l=(t,e)=>t.children[e].textContent;if(s&&r.options.exporting&&r.options.exporting.allowTableSorting){let t=s.querySelector("thead tr");t&&t.childNodes.forEach(a=>{let o=a.closest("table");a.addEventListener("click",function(){let t=[...s.querySelectorAll("tr:not(thead tr)")],e=[...a.parentNode.children];var n,i;t.sort((n=e.indexOf(a),i=r.ascendingOrderInTable=!r.ascendingOrderInTable,(t,e)=>{let a,o;return a=l(i?t:e,n),o=l(i?e:t,n),""===a||""===o||isNaN(a)||isNaN(o)?a.toString().localeCompare(o):a-o})).forEach(t=>{o.appendChild(t)}),e.forEach(e=>{["highcharts-sort-ascending","highcharts-sort-descending"].forEach(t=>{e.classList.contains(t)&&e.classList.remove(t)})}),a.classList.add(r.ascendingOrderInTable?"highcharts-sort-ascending":"highcharts-sort-descending")})})}}function F(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}function j(){this.dataTableDiv?.remove()}let B=e();B.dataURLtoBlob=B.dataURLtoBlob||d.dataURLtoBlob,B.downloadURL=B.downloadURL||d.downloadURL;{c=B.Chart,d=B.Series;let s=c.prototype;if(!s.getCSV){let t=g().exporting,{arearange:e,gantt:a,map:o,mapbubble:n,treemap:i,xrange:r}=(y(c,"afterViewData",M),y(c,"render",F),y(c,"destroy",j),s.downloadCSV=T,s.downloadXLS=D,s.getCSV=S,s.getDataRows=L,s.getTable=H,s.getTableAST=R,s.hideData=N,s.toggleDataTable=U,s.viewData=I,t&&(w(t.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){v.call(this,this.toggleDataTable)}}}),t.buttons&&t.buttons.contextButton.menuItems&&t.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")),f(u),d.types);e&&(e.prototype.keyToAxis={low:"y",high:"y"}),a&&(a.prototype.exportKey="name",a.prototype.keyToAxis={start:"x",end:"x"}),o&&(o.prototype.exportKey="name"),n&&(n.prototype.exportKey="name"),i&&(i.prototype.exportKey="name"),r&&(r.prototype.keyToAxis={x2:"x"})}}let P=e();return t.default})());