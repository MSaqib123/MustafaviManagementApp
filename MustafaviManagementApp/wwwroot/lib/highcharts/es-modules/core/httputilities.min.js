"use strict";import G from"../Core/Globals.js";const win=G["win"];import U from"../Core/Utilities.js";const{discardElement,objectEach}=U;function ajax(n){const t={json:"application/json",xml:"application/xml",text:"text/plain",octet:"application/octet-stream"},a=new XMLHttpRequest;function e(t,e){n.error&&n.error(t,e)}if(!n.url)return!1;a.open((n.type||"get").toUpperCase(),n.url,!0),n.headers?.["Content-Type"]||a.setRequestHeader("Content-Type",t[n.dataType||"json"]||t.text),objectEach(n.headers,function(t,e){a.setRequestHeader(e,t)}),n.responseType&&(a.responseType=n.responseType),a.onreadystatechange=function(){let t;if(4===a.readyState){if(200===a.status){if("blob"!==n.responseType&&(t=a.responseText,"json"===n.dataType))try{t=JSON.parse(t)}catch(t){if(t instanceof Error)return e(a,t)}return n.success?.(t,a)}e(a,a.responseText)}},n.data&&"string"!=typeof n.data&&(n.data=JSON.stringify(n.data)),a.send(n.data)}function getJSON(t,e){HttpUtilities.ajax({url:t,success:e,dataType:"json",headers:{"Content-Type":"text/plain"}})}function post(t,e,n){const a=new win.FormData,{filename:o,type:s}=(objectEach(e,function(t,e){a.append(e,t)}),a.append("b64","true"),e);return win.fetch(t,{method:"POST",body:a,...n}).then(t=>{t.ok&&t.text().then(t=>{const e=document.createElement("a");e.href=`data:${s};base64,`+t,e.download=o,e.click(),discardElement(e)})})}const HttpUtilities={ajax:ajax,getJSON:getJSON,post:post};export default HttpUtilities;